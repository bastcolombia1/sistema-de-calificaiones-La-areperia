<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Califica tu experiencia</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Pantalla de carga inicial -->
        <div id="loading-screen" class="screen active">
            <div class="spinner"></div>
            <p>Cargando...</p>
        </div>

        <!-- Pantalla de error de configuración -->
        <div id="error-screen" class="screen">
            <div class="error-icon">⚠️</div>
            <h2>Error de configuración</h2>
            <p id="error-message">No se pudo cargar la configuración del punto de venta.</p>
        </div>

        <!-- Pantalla de selección de sede (protegida con PIN) -->
        <div id="setup-screen" class="screen">
            <div class="setup-content">
                <h2>Configuración de Sede</h2>

                <div id="pin-section">
                    <p>Ingrese el PIN de administrador</p>
                    <div class="input-group">
                        <input
                            type="password"
                            id="admin-pin"
                            placeholder="****"
                            maxlength="4"
                            inputmode="numeric"
                            autocomplete="off"
                        >
                        <span id="pin-error" class="error-text hidden">PIN incorrecto</span>
                    </div>
                    <button id="btn-verify-pin" class="btn-primary">Verificar</button>
                </div>

                <div id="sede-section" class="hidden">
                    <p>Seleccione el punto de venta</p>
                    <div class="input-group">
                        <select id="sede-select">
                            <option value="">Cargando sedes...</option>
                        </select>
                    </div>
                    <button id="btn-save-sede" class="btn-primary" disabled>Guardar Configuración</button>
                    <button id="btn-fullscreen" class="btn-secondary btn-fullscreen">Pantalla Completa</button>
                    <p class="setup-hint">Esta configuración se guardará en este dispositivo</p>
                </div>
            </div>
        </div>

        <!-- Pantalla principal - Ingreso de factura -->
        <div id="invoice-screen" class="screen">
            <header>
                <img id="logo" src="" alt="Logo" class="logo hidden">
                <h1 id="brand-name">Cargando...</h1>
                <p id="store-name" class="store-name"></p>
            </header>

            <main>
                <h2>¡Queremos conocer tu opinión!</h2>
                <p class="instruction">Ingresa el número de tu factura para calificar tu experiencia</p>

                <div class="input-group">
                    <label for="invoice-number">Número de factura</label>
                    <div class="input-with-prefix">
                        <span id="invoice-prefix" class="invoice-prefix"></span>
                        <input
                            type="text"
                            id="invoice-number"
                            placeholder="12345"
                            autocomplete="off"
                            inputmode="numeric"
                        >
                    </div>
                    <span id="invoice-error" class="error-text hidden">Por favor ingresa el número de factura</span>
                </div>

                <button id="btn-continue" class="btn-primary">Continuar</button>
            </main>
        </div>

        <!-- Pantalla de calificación -->
        <div id="rating-screen" class="screen">
            <header>
                <img id="logo-rating" src="" alt="Logo" class="logo hidden">
                <h1 id="brand-name-rating"></h1>
                <p id="store-name-rating" class="store-name"></p>
            </header>

            <main>
                <h2>¿Cómo fue tu experiencia?</h2>
                <p class="invoice-display">Factura: <strong id="display-invoice"></strong></p>

                <div class="rating-options">
                    <button class="rating-btn" data-rating="1" aria-label="Mala experiencia">
                        <img src="assets/enojado.png" alt="Malo" class="rating-img">
                        <span class="label">Malo</span>
                    </button>
                    <button class="rating-btn" data-rating="2" aria-label="Experiencia regular">
                        <img src="assets/serio.png" alt="Regular" class="rating-img">
                        <span class="label">Regular</span>
                    </button>
                    <button class="rating-btn" data-rating="3" aria-label="Buena experiencia">
                        <img src="assets/feliz.png" alt="Bueno" class="rating-img">
                        <span class="label">Bueno</span>
                    </button>
                </div>

                <div class="comment-section">
                    <label for="comment">¿Algo que quieras contarnos? (opcional)</label>
                    <textarea
                        id="comment"
                        rows="3"
                        placeholder="Escribe tu comentario aquí..."
                        maxlength="500"
                    ></textarea>
                    <span class="char-count"><span id="char-current">0</span>/500</span>
                </div>

                <div class="button-group">
                    <button id="btn-back" class="btn-secondary">Volver</button>
                    <button id="btn-submit" class="btn-primary" disabled>Enviar</button>
                </div>
            </main>
        </div>

        <!-- Pantalla de agradecimiento -->
        <div id="thanks-screen" class="screen">
            <div class="thanks-content">
                <div class="success-icon">✓</div>
                <h2>¡Gracias por tu opinión!</h2>
                <p>Tu calificación nos ayuda a mejorar nuestro servicio.</p>

                <div class="qr-section">
                    <p class="qr-text">Registrate en nuestra base de datos y sé el primero en recibir nuestras promociones</p>
                    <img src="assets/qr_encuesta.png" alt="QR Encuesta" class="qr-code">
                    <p class="qr-instruction">Escanea el código QR</p>
                </div>

                <p class="countdown">Esta pantalla se cerrará en <span id="countdown">25</span> segundos...</p>
            </div>
        </div>

        <!-- Pantalla de envío -->
        <div id="submitting-screen" class="screen">
            <div class="spinner"></div>
            <p>Enviando tu calificación...</p>
        </div>

        <!-- Footer -->
        <footer class="app-footer">
            <p>Desarrollado por <strong>Bast Automation SAS</strong> & <strong>Blast Ideas SAS</strong></p>
            <p><a href="mailto:cristianmolina@bastcolombia.com">cristianmolina@bastcolombia.com</a></p>
        </footer>
    </div>

    <script src="config.js"></script>
    <script src="app.js"></script>
</body>
</html>
